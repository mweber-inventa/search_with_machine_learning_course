head -10000 /workspace/datasets/fasttext/shuffled_labeled_products.txt > /workspace/datasets/fasttext/training_data.txt
tail -10000 /workspace/datasets/fasttext/shuffled_labeled_products.txt > /workspace/datasets/fasttext/test_data.txt

~/fastText-0.9.2/fasttext supervised -input /workspace/datasets/fasttext/test_data.txt -output model_bbuy

~/fastText-0.9.2/fasttext test model_bbuy.bin /workspace/datasets/fasttext/test_data.txt
~/fastText-0.9.2/fasttext test model_bbuy.bin /workspace/datasets/fasttext/test_data.txt 5


~/fastText-0.9.2/fasttext supervised -input /workspace/datasets/fasttext/training_data.txt -output model_bbuy -epoch 25 -lr 1.0 -wordNgrams 2
~/fastText-0.9.2/fasttext test model_bbuy.bin /workspace/datasets/fasttext/test_data.txt
~/fastText-0.9.2/fasttext test model_bbuy.bin /workspace/datasets/fasttext/test_data.txt 5

cat /workspace/datasets/fasttext/shuffled_labeled_products.txt |sed -e "s/\([.\!?,'/()]\)/ \1 /g" | tr "[:upper:]" "[:lower:]" | sed "s/[^[:alnum:]_]/ /g" | tr -s ' ' > /workspace/datasets/fasttext/normalized_labeled_products.txt
head -3 /workspace/datasets/fasttext/shuffled_labeled_products.txt
head -3 /workspace/datasets/fasttext/normalized_labeled_products.txt

head -10000 /workspace/datasets/fasttext/normalized_labeled_products.txt > /workspace/datasets/fasttext/norm_training_data.txt
tail -10000 /workspace/datasets/fasttext/normalized_labeled_products.txt > /workspace/datasets/fasttext/norm_test_data.txt

~/fastText-0.9.2/fasttext supervised -input /workspace/datasets/fasttext/norm_training_data.txt -output model_bbuy_norm -epoch 25 -lr 1.0 -wordNgrams 2
~/fastText-0.9.2/fasttext test model_bbuy_norm.bin /workspace/datasets/fasttext/norm_test_data.txt
~/fastText-0.9.2/fasttext test model_bbuy_norm.bin /workspace/datasets/fasttext/norm_test_data.txt 5


In ipython:

import pandas as pd

item_count_threshold = 500

df = pd.read_fwf('/workspace/datasets/fasttext/shuffled_labeled_products.txt', header=None, names=['text'])

def expand_labels_and_text(df, col='text'):
    return df[col].split(' ')[0], ' '.join(df[col].split(' ')[1:])

df[['label', 'description']] = df.apply(expand_labels_and_text, axis=1, result_type='expand')
df['item_count'] = df.groupby('label').transform('count')['description']

df_output = df[df['item_count']>=item_count_threshold]['text']
df_output.to_csv('/workspace/datasets/fasttext/pruned_labeled_products.txt', index=False, header=False)

